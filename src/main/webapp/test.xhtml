<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html">

    <h:head>
        <title>PrimeFaces Test</title>
    </h:head>
    <h:body>

        <h1>PrimeFaces Dynamic Datatable Columns Test</h1>

        <h:form id="theForm">
            <p:dataTable id="tab" widgetVar="tab"
                         value="#{testViewCdi.tableData}"
                         var="_data"
                         multiViewState="true">

                <p:column id="static" headerText="Static Col ID"
                          toggleable="false"
                          sortBy="#{_data.id}" filterBy="#{_data.id}">
                    #{_data.id}
                </p:column>

                <p:columns value="#{testViewCdi.columns}" var="_col"
                           sortable="#{_col.sort != null}"
                           sortBy="#{_data[_col.sort]}"
                           filterable="#{_col.filter != null}"
                           filterBy="#{_data[_col.filter]}"
                           filterMatchMode="contains">
                    <f:facet name="header">
                        <h:outputText value="#{_col.header}" />
                    </f:facet>
                    <h:outputText value="#{_data[_col.property]}" />
                </p:columns>
            </p:dataTable>

            <p:selectManyMenu id="cols" value="#{testViewCdi.columns}"
                              var="_item"
                              showCheckbox="true" converter="omnifaces.SelectItemsIndexConverter">
                <f:selectItems value="#{testViewCdi.allColumns}" var="_c" itemLabel="#{_c.header}"/>
                <p:column>#{_item.header}</p:column>
                <p:ajax update="tab" oncomplete="PF('tab').clearFilters()"/>
            </p:selectManyMenu>

        </h:form>

    </h:body>
</html>